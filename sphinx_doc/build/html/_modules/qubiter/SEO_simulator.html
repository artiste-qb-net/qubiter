

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>qubiter.SEO_simulator &mdash; qubiter 1.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> qubiter
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rosetta.html">Rosetta Stone</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classgraph.html">Class Graph</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">qubiter</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>qubiter.SEO_simulator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for qubiter.SEO_simulator</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="c1"># import pprint as pp</span>
<span class="kn">from</span> <span class="nn">qubiter.SEO_reader</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qubiter.OneBitGates</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qubiter.StateVec</span> <span class="k">import</span> <span class="o">*</span>
<span class="c1"># import utilities_gen as ut</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="s1">&#39;autograd.numpy&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<div class="viewcode-block" id="SEO_simulator"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator">[docs]</a><span class="k">class</span> <span class="nc">SEO_simulator</span><span class="p">(</span><span class="n">SEO_reader</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class simulates the evolution of a quantum state vector.</span>

<span class="sd">    This class has SEO_reader as a parent. Each line of an English file is</span>
<span class="sd">    read by the parent class and handed over to the use_ functions of this</span>
<span class="sd">    simulator class. The use_  functions multiply the current state vector by</span>
<span class="sd">    the unitary matrix that represents the latest line read.</span>

<span class="sd">    An initial state vector can be entered via the constructor or else it is</span>
<span class="sd">    set to the ground state automatically by the constructor.</span>

<span class="sd">    3 kinds (called 0, 1, 2) of measurements MEAS are allowed. A type 0</span>
<span class="sd">    measurement inserts a projector |0&gt;&lt;0| = n = P_0 at the target bit. A</span>
<span class="sd">    type 1 measurement inserts a projector |1&gt;&lt;1| = nbar = P_1 at the target</span>
<span class="sd">    bit. A type 2 measurement stores a copy of the state vector after |0&gt;&lt;0|</span>
<span class="sd">    has been applied, and another copy after |1&gt;&lt;1| has been applied.</span>

<span class="sd">    self.cur_st_vec_dict is a dictionary of strings (called branch keys) to</span>
<span class="sd">    state vectors StateVec on num_bits qubits. We will refer to each state</span>
<span class="sd">    vec in the dict as a branch. Initially, this dict contains a single</span>
<span class="sd">    branch with branch key = &quot;pure&quot;. A measurement MEAS of kinds 0 or 1 does</span>
<span class="sd">    not change the number of branches in the dict, but a measurement of kind</span>
<span class="sd">    2 doubles their number.</span>

<span class="sd">    Note that since projectors are not unitary matrices, the branches of</span>
<span class="sd">    cur_st_vec_dict are not expected have normalized state vectors as values</span>
<span class="sd">    except when there is only a single branch.</span>

<span class="sd">    If cur_st_vec_dict contains as values the states |br0&gt;, |br1&gt;, |br2&gt;,</span>
<span class="sd">    ...], then one can construct the density matrix of that state as rho =</span>
<span class="sd">    |br0&gt;&lt;br0| + |br1&gt;&lt;br1| + |br2&gt;&lt;br2| + ... divided by a number so that</span>
<span class="sd">    trace(rho)=1. In other words, cur_st_vec_dict is just a particular way</span>
<span class="sd">    of storing the density matrix of a state. A state with a single branch</span>
<span class="sd">    is a pure state, but a state with more than one branch may not be.</span>

<span class="sd">    An item of cur_st_vec_dict may be key=some string, value=None. This</span>
<span class="sd">    means the state vector of that branch is zero.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    cached_sts : dict[int, dict(str, StateVec)]</span>
<span class="sd">        A dictionary mapping an int to past values of self.cur_st_vec_dict.</span>
<span class="sd">        Used by use_PRINT() sometimes.</span>
<span class="sd">    cur_st_vec_dict : dict(str, StateVec)</span>
<span class="sd">        dictionary with key= branch_key string and value= StateVec|None. If</span>
<span class="sd">        there is a single item in dict, the dict represents a pure state and</span>
<span class="sd">        the key is &quot;pure&quot;. If there is more than one item, the dict</span>
<span class="sd">        represents a mixed state and each branch key is a string that</span>
<span class="sd">        uniquely characterizes the measured controls. For example, if it has</span>
<span class="sd">        been measured previously (type 2 measurement only) that qubit 2 is</span>
<span class="sd">        True and qubit 4 is False, the branch key will be &#39;4F2T&#39;.</span>
<span class="sd">    lib : str</span>
<span class="sd">        tensor library. Either &#39;np&#39; for numpy or &#39;tf&#39; for tensorflow</span>
<span class="sd">    tensordot : function</span>
<span class="sd">    transpose : function</span>
<span class="sd">    use_tf : bool</span>
<span class="sd">        True iff using TensorFlow Eager. False by default</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># class variables</span>
    <span class="n">transpose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span>
    <span class="n">tensordot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tensordot</span>
    <span class="n">reshape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span>

    <span class="c1"># rrtucci: combines my java classes:</span>
    <span class="c1"># LineList, UnitaryMat, SEO_readerMu</span>

<div class="viewcode-block" id="SEO_simulator.__init__"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_prefix</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">,</span>
                 <span class="n">init_st_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_prefix : str</span>
<span class="sd">        num_bits : int</span>
<span class="sd">        init_st_vec : StateVec</span>
<span class="sd">            get this using the functions StateVec.get_ground_st_vec() or</span>
<span class="sd">            StateVec.get_standard_basis_st_vec().</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="n">init_st_vec</span><span class="p">):</span>
            <span class="n">init_st_vec</span> <span class="o">=</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">get_ground_st_vec</span><span class="p">(</span><span class="n">num_bits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pure&quot;</span><span class="p">:</span> <span class="n">init_st_vec</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached_sts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tf</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib</span> <span class="o">=</span> <span class="s1">&#39;np&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">do_more_init_before_reading</span><span class="p">()</span>

        <span class="n">SEO_reader</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_prefix</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.do_more_init_before_reading"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.do_more_init_before_reading">[docs]</a>    <span class="k">def</span> <span class="nf">do_more_init_before_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stub. Called in SEO_simulator.__init__ immediately before calling</span>
<span class="sd">        SEO_reader.__init__</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SEO_simulator.branch_is_part_of_mcase"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.branch_is_part_of_mcase">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">branch_is_part_of_mcase</span><span class="p">(</span><span class="n">br_trols</span><span class="p">,</span> <span class="n">case_trols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True iff the controls br_trols defining a branch of</span>
<span class="sd">        self.cur_st_vec_dict agree with the controls case_trols defining a</span>
<span class="sd">        case measured.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        br_trols : Controls</span>
<span class="sd">        case_trols : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">br_trols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">case_trols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">br_dict</span> <span class="o">=</span> <span class="n">br_trols</span><span class="o">.</span><span class="n">bit_pos_to_kind</span>
        <span class="n">case_dict</span> <span class="o">=</span> <span class="n">case_trols</span><span class="o">.</span><span class="n">bit_pos_to_kind</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">case_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">br_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">case_dict</span><span class="p">[</span><span class="n">bit</span><span class="p">]</span> <span class="o">!=</span> <span class="n">br_dict</span><span class="p">[</span><span class="n">bit</span><span class="p">]:</span>
                    <span class="n">ans</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>
        <span class="c1"># print(&#39;\n&#39;)</span>
        <span class="c1"># print(&#39;br_trols&#39;, br_trols.bit_pos_to_kind)</span>
        <span class="c1"># print(&#39;case_trols&#39;, case_trols.bit_pos_to_kind)</span>
        <span class="c1"># print(&#39; is part of case&#39;, ans)</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="SEO_simulator.get_controls_from_br_key"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.get_controls_from_br_key">[docs]</a>    <span class="k">def</span> <span class="nf">get_controls_from_br_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">br_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Controls object built from br_key. br_key is assumed to be</span>
<span class="sd">        a str key for self.cur_st_vec_dict</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        br_key : str</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Controls</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">br_key</span> <span class="o">!=</span> <span class="s2">&quot;pure&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">br_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot; T &quot;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot; F &quot;</span><span class="p">)</span>
        <span class="n">li</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="c1"># print(&quot;li&quot;, li)</span>
        <span class="n">bit_pos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kinds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">li</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">bit_pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                    <span class="n">kinds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">kinds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">trols</span> <span class="o">=</span> <span class="n">Controls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span><span class="p">)</span>
        <span class="n">trols</span><span class="o">.</span><span class="n">bit_pos_to_kind</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bit_pos</span><span class="p">,</span> <span class="n">kinds</span><span class="p">))</span>
        <span class="n">trols</span><span class="o">.</span><span class="n">refresh_lists</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">trols</span></div>

<div class="viewcode-block" id="SEO_simulator.get_br_key_with_new_link"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.get_br_key_with_new_link">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_br_key_with_new_link</span><span class="p">(</span><span class="n">br_key</span><span class="p">,</span> <span class="n">new_bit_pos</span><span class="p">,</span> <span class="n">new_kind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Say new_bit_pos=2 and new_kind=True. This returns a new branch key</span>
<span class="sd">        with &#39;2T&#39; added to the end of the string br_key</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        br_key : str</span>
<span class="sd">        new_bit_pos : int</span>
<span class="sd">        new_kind : bool</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_bit_pos</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span> <span class="k">if</span> <span class="n">new_kind</span> <span class="k">else</span> <span class="s2">&quot;F&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">br_key</span> <span class="o">==</span> <span class="s2">&quot;pure&quot;</span><span class="p">:</span>
            <span class="n">new_br_key</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_br_key</span> <span class="o">=</span> <span class="n">br_key</span> <span class="o">+</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">new_br_key</span></div>

<div class="viewcode-block" id="SEO_simulator.evolve_by_controlled_bit_swap"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.evolve_by_controlled_bit_swap">[docs]</a>    <span class="k">def</span> <span class="nf">evolve_by_controlled_bit_swap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evolve each branch of cur_st_vec_dict by controlled bit swap iff the</span>
<span class="sd">        bit swap line is (1) outside of any IF_M block, or (2) it is inside</span>
<span class="sd">        such a block, and it satisfies self.mcase_trols.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bit1 : int</span>
<span class="sd">        bit2 : int</span>
<span class="sd">            bit1 and bit2 are the positions of the 2 bits being swapped.</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">bit1</span> <span class="o">!=</span> <span class="n">bit2</span><span class="p">,</span> <span class="s2">&quot;swapped bits must be different&quot;</span>
        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="p">[</span><span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">bit</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span>
            <span class="k">assert</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span>
 
        <span class="n">slicex</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span>
        <span class="n">num_controls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="o">.</span><span class="n">bit_pos_to_kind</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_controls</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">controls</span><span class="o">.</span><span class="n">kinds</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">bool</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">controls</span><span class="o">.</span><span class="n">kinds</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>  <span class="c1"># it&#39;s True</span>
                <span class="n">slicex</span><span class="p">[</span><span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># it&#39;s False</span>
                <span class="n">slicex</span><span class="p">[</span><span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">slicex</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">slicex</span><span class="p">)</span>

        <span class="c1"># components that are fixed are no longer axes</span>
        <span class="n">scout</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="n">bit1</span><span class="p">:</span>
                <span class="n">new1</span> <span class="o">=</span> <span class="n">scout</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="n">bit2</span><span class="p">:</span>
                <span class="n">new2</span> <span class="o">=</span> <span class="n">scout</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span><span class="p">:</span>
                <span class="n">scout</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># perm = permutation that will use in transpose()</span>
        <span class="n">perm_len</span> <span class="o">=</span> <span class="n">scout</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">perm_len</span><span class="p">))</span>
        <span class="n">perm</span><span class="p">[</span><span class="n">new1</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">new2</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">new2</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">new1</span><span class="p">]</span>

        <span class="c1"># br = branch</span>
        <span class="k">for</span> <span class="n">br_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="n">evolve_br</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">measured_bits</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcase_trols</span><span class="p">:</span>
                <span class="n">evolve_br</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">br_trols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_controls_from_br_key</span><span class="p">(</span><span class="n">br_key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">SEO_simulator</span><span class="o">.</span><span class="n">branch_is_part_of_mcase</span><span class="p">(</span>
                        <span class="n">br_trols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcase_trols</span><span class="p">):</span>
                    <span class="n">evolve_br</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">evolve_br</span><span class="p">:</span>
                <span class="n">sub_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">slicex</span><span class="p">]</span>
                <span class="n">sub_arr</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">sub_arr</span><span class="p">,</span> <span class="n">perm</span><span class="p">)</span>

                <span class="c1"># can&#39;t do array assignments with autograd or tensorflow</span>
                <span class="c1"># eager so achieve same result with other allowed tensor ops</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tf</span> <span class="ow">or</span> <span class="s1">&#39;autograd.numpy&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">do_array_assignment_workaround</span><span class="p">(</span>
                        <span class="n">br_key</span><span class="p">,</span> <span class="n">slicex</span><span class="p">,</span> <span class="n">sub_arr</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">slicex</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_arr</span></div>

<div class="viewcode-block" id="SEO_simulator.evolve_by_controlled_one_bit_gate"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.evolve_by_controlled_one_bit_gate">[docs]</a>    <span class="k">def</span> <span class="nf">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">one_bit_gate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evolve each branch of cur_st_vec_dict by controlled one bit gate (</span>
<span class="sd">        from class OneBitGates) iff the controlled one bit gate line is (1)</span>
<span class="sd">        outside of an IF_M block, or (2) it is inside such a block, and it</span>
<span class="sd">        satisfies self.mcase_trols. Note one_bit_gate is entered as</span>
<span class="sd">        np.ndarray.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">            bit position of target of one bit gate.</span>
<span class="sd">        controls : Controls</span>
<span class="sd">        one_bit_gate : np.ndarray</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">tar_bit_pos</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span>

        <span class="n">vec_slicex</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span>
        <span class="n">num_controls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="o">.</span><span class="n">bit_pos_to_kind</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_controls</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">controls</span><span class="o">.</span><span class="n">kinds</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">bool</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">controls</span><span class="o">.</span><span class="n">kinds</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>  <span class="c1"># it&#39;s True</span>
                <span class="n">vec_slicex</span><span class="p">[</span><span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># it&#39;s False</span>
                <span class="n">vec_slicex</span><span class="p">[</span><span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">vec_slicex</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">vec_slicex</span><span class="p">)</span>

        <span class="c1"># components that are fixed are no longer axes</span>
        <span class="n">scout</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="n">tar_bit_pos</span><span class="p">:</span>
                <span class="n">new_tar</span> <span class="o">=</span> <span class="n">scout</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">controls</span><span class="o">.</span><span class="n">bit_pos</span><span class="p">:</span>
                <span class="n">scout</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">perm_len</span> <span class="o">=</span> <span class="n">scout</span>
        <span class="c1"># example tar = 2</span>
        <span class="c1"># want to map [2, 0, 1, 3, 4] back to [0, 1, 2, 3, 4]</span>

        <span class="c1"># this didn&#39;t work</span>
        <span class="c1"># use perm 0=&gt;2, 1=&gt;0, 2=&gt;1, 3=&gt;3, 4=&gt;4</span>
        <span class="c1"># perm = [new_tar] + list(range(new_tar))</span>
        <span class="c1"># perm += list(range(new_tar+1, perm_len))</span>

        <span class="c1"># use perm 2=&gt;0, 0=&gt;1, 1=&gt;2, 3=&gt;3, 4=&gt;4</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_tar</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">perm</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">new_tar</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">perm_len</span><span class="p">))</span>

        <span class="c1"># br = branch</span>
        <span class="k">assert</span> <span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcase_trols</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">measured_bits</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">br_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="n">evolve_br</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">measured_bits</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcase_trols</span><span class="p">:</span>
                <span class="n">evolve_br</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="n">br_trols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_controls_from_br_key</span><span class="p">(</span><span class="n">br_key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">SEO_simulator</span><span class="o">.</span><span class="n">branch_is_part_of_mcase</span><span class="p">(</span>
                        <span class="n">br_trols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcase_trols</span><span class="p">):</span>
                    <span class="n">evolve_br</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">evolve_br</span><span class="p">:</span>
                <span class="n">sub_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">vec_slicex</span><span class="p">]</span>
                <span class="c1"># Axes 1 of one_bit_gate and new_tar of vec are summed over.</span>
                <span class="c1">#  Axis 0 of one_bit_gate goes to the front of all the axes</span>
                <span class="c1"># of new vec. Use transpose() to realign axes.</span>
                <span class="n">sub_arr</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">one_bit_gate</span><span class="p">,</span> <span class="n">sub_arr</span><span class="p">,</span>
                                         <span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">new_tar</span><span class="p">]))</span>
                <span class="n">sub_arr</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">sub_arr</span><span class="p">,</span> <span class="n">perm</span><span class="p">)</span>

                <span class="c1"># can&#39;t do array assignments with autograd or tensorflow</span>
                <span class="c1"># eager so achieve same result with other allowed tensor ops</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tf</span> <span class="ow">or</span> <span class="s1">&#39;autograd.numpy&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">do_array_assignment_workaround</span><span class="p">(</span>
                        <span class="n">br_key</span><span class="p">,</span> <span class="n">vec_slicex</span><span class="p">,</span> <span class="n">sub_arr</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="c1"># original, if autograd is not being used</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">vec_slicex</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_arr</span></div>

<div class="viewcode-block" id="SEO_simulator.do_array_assignment_workaround"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.do_array_assignment_workaround">[docs]</a>    <span class="k">def</span> <span class="nf">do_array_assignment_workaround</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">br_key</span><span class="p">,</span> <span class="n">slicex</span><span class="p">,</span> <span class="n">sub_arr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        internal function used in evolve_ methods iff autograd is on or</span>
<span class="sd">        use_tf is True. Should have same effect as</span>

<span class="sd">        self.cur_st_vec_dict[br_key].arr[slicex] = sub_arr</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        br_key : str</span>
<span class="sd">        slicex : tuple</span>
<span class="sd">        sub_arr : np.ndarray</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">test</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span>

        <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
            <span class="c1"># This creates a numpy copy of arr if arr is numpy.</span>
            <span class="c1"># If arr is tf, it converts to numpy then creates a numpy copy</span>
            <span class="n">arr1_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
            <span class="c1"># print(&#39;arr1 bef&#39;, arr1_np)</span>
            <span class="n">arr1_np</span><span class="p">[</span><span class="n">slicex</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sub_arr</span><span class="p">)</span>
            <span class="c1"># print(&#39;arr1 aft&#39;, arr1_np)</span>
        <span class="n">on_slicex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">on_slicex</span><span class="p">[</span><span class="n">slicex</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">bigger_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span>  <span class="c1"># slicex is num_bits long</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># print(&#39;wwwww&#39;, sub_arr.shape, slicex)</span>
        <span class="k">for</span> <span class="n">bit</span><span class="p">,</span> <span class="n">kind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slicex</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">bigger_shape</span><span class="p">[</span><span class="n">bit</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sub_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">one_on_slicex</span> <span class="o">=</span> <span class="n">on_slicex</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">not_one_on_slicex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">on_slicex</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">sub_arr</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sub_arr</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">bigger_shape</span><span class="p">))</span>

        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">*</span><span class="n">not_one_on_slicex</span> <span class="o">+</span> <span class="n">sub_arr</span><span class="o">*</span><span class="n">one_on_slicex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span>

        <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
            <span class="c1"># print(&#39;arr aft&#39;, arr)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;testing simulator ruse&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">-</span><span class="n">arr1_np</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">,</span> \
                <span class="s1">&#39;sim ruse test failed&#39;</span></div>

<div class="viewcode-block" id="SEO_simulator.convert_tensors_to_numpy"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.convert_tensors_to_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">convert_tensors_to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is meant to be overridden to replace tensorflow tensors</span>
<span class="sd">        (or some other non-numpy tensor type) by numpy tensors.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SEO_simulator.convert_tensors_to_tf"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.convert_tensors_to_tf">[docs]</a>    <span class="k">def</span> <span class="nf">convert_tensors_to_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is meant to be overridden to replace numpy tensors by</span>
<span class="sd">        tensorflow tensors (or some other non-numpy tensor type).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SEO_simulator.finalize_next_line"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.finalize_next_line">[docs]</a>    <span class="k">def</span> <span class="nf">finalize_next_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints running documentary at the end of the reading of each line.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;line number = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_count</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;operation = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_ops</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">describe_st_vec_dict</span><span class="p">(</span>  <span class="c1"># print_st_vec=True,</span>
                                    <span class="n">show_probs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.describe_st_vec_dict"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.describe_st_vec_dict">[docs]</a>    <span class="k">def</span> <span class="nf">describe_st_vec_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls method with same name in class StateVec. It prints a</span>
<span class="sd">        description of the current state vector dictionary. Can call this at</span>
<span class="sd">        the end, after running through whole circuit.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs : dict</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_numpy</span><span class="p">()</span>
        <span class="n">StateVec</span><span class="o">.</span><span class="n">describe_st_vec_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_tf</span><span class="p">()</span></div>

<div class="viewcode-block" id="SEO_simulator.get_counts"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.get_counts">[docs]</a>    <span class="k">def</span> <span class="nf">get_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_shots</span><span class="p">,</span> <span class="n">omit_zero_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">use_bin_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rand_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method calculates a probability distribution that we call pd</span>
<span class="sd">        from the current state vector if it is pure. (If the state vec is</span>
<span class="sd">        not pure, it calculates a density matrix from the</span>
<span class="sd">        self.cur_st_vec_dict. Then it extracts the diagonal of that density</span>
<span class="sd">        matrix. That diagonal must be a probability distribution that we</span>
<span class="sd">        call pd.) Then the method samples pd, num_shots times. The method</span>
<span class="sd">        returns the result of that sampling as an OrderedDict</span>
<span class="sd">        state_name_to_counts. Depending on the value of the flag</span>
<span class="sd">        use_bin_labels, the state names are a string &#39;0&#39;, &#39;1&#39;, &#39;2&#39;, etc,</span>
<span class="sd">        or their binary representations followed by &#39;ZL&#39;, because the ZL</span>
<span class="sd">        convention is assumed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_shots : int</span>
<span class="sd">        omit_zero_counts : bool</span>
<span class="sd">        use_bin_labels : bool</span>
<span class="sd">        rand_seed : int</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OrderedDict[str, int]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_numpy</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># print(&#39;..,,mm&#39;, &#39;was here&#39;)</span>
            <span class="n">pd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="s1">&#39;pure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_pd</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">den_mat</span> <span class="o">=</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">get_den_mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">)</span>
            <span class="n">pd</span> <span class="o">=</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">get_den_mat_pd</span><span class="p">(</span><span class="n">den_mat</span><span class="p">)</span>
        <span class="c1"># print(&#39;....,,,&#39;, pd.shape)</span>
        <span class="n">obs_vec</span> <span class="o">=</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">get_observations_vec</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">num_shots</span><span class="p">,</span> <span class="n">rand_seed</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">get_counts_from_obs_vec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span><span class="p">,</span> <span class="n">obs_vec</span><span class="p">,</span>
                        <span class="n">use_bin_labels</span><span class="p">,</span> <span class="n">omit_zero_counts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_tf</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="SEO_simulator.use_DIAG"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_DIAG">[docs]</a>    <span class="k">def</span> <span class="nf">use_DIAG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trols</span><span class="p">,</span> <span class="n">rad_angles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method should not be called. If called, it explains why it</span>
<span class="sd">        shouldn&#39;t be called.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trols : Controls</span>
<span class="sd">        rad_angles : list[float]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> \
            <span class="s2">&quot;This class cannot simulate a circuit containing &quot;</span> \
            <span class="s2">&quot;raw diagonal unitaries DIAG. Work around: use first our&quot;</span> \
            <span class="s2">&quot;DiagUnitaryExpander class to expand &quot;</span> \
            <span class="s2">&quot;DIAGs into simpler gates.&quot;</span></div>

<div class="viewcode-block" id="SEO_simulator.use_HAD2"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_HAD2">[docs]</a>    <span class="k">def</span> <span class="nf">use_HAD2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for had2.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">had2</span><span class="p">(</span><span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_IF_M_beg"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_IF_M_beg">[docs]</a>    <span class="k">def</span> <span class="nf">use_IF_M_beg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do nothing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SEO_simulator.use_IF_M_end"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_IF_M_end">[docs]</a>    <span class="k">def</span> <span class="nf">use_IF_M_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do nothing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SEO_simulator.use_MEAS"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_MEAS">[docs]</a>    <span class="k">def</span> <span class="nf">use_MEAS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function.</span>

<span class="sd">        For kind 0 (resp., 1) measurements, it applies |0&gt;&lt;0| (resp.,</span>
<span class="sd">        |1&gt;&lt;1|) to each branch of cur_st_vec_dict.</span>

<span class="sd">        For kind 2 measurements, it first doubles the number of branches in</span>
<span class="sd">        cur_st_vec_dict by adding a deep copy of each branch. Next,</span>
<span class="sd">        it applies P_0 to half of the branches of the dict and P_1 to the</span>
<span class="sd">        other half.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kind : int</span>
<span class="sd">        tar_bit_pos: int</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_numpy</span><span class="p">()</span>
        <span class="c1"># slicex = slice index</span>
        <span class="n">slicex</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bits</span>
        <span class="c1"># br = branch</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">br_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">:</span>
                <span class="n">st_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="n">st_vec</span><span class="p">):</span>
                    <span class="n">slicex</span><span class="p">[</span><span class="n">tar_bit_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
                    <span class="c1"># set projection |b=0&gt;&lt;b=0| to zero for kind=1</span>
                    <span class="n">st_vec</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slicex</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">tot_prob</span> <span class="o">=</span> <span class="n">st_vec</span><span class="o">.</span><span class="n">get_total_prob</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">tot_prob</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">:</span>
                        <span class="c1"># this didn&#39;t work</span>
                        <span class="c1"># st_vec.arr = None</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">slicex</span><span class="p">[</span><span class="n">tar_bit_pos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="c1"># self.cur_st_vec_dict[br_key].arr = st_vec.arr</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">old_st_vec_dict</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">br_key</span> <span class="ow">in</span> <span class="n">old_st_vec_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">new_T_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_br_key_with_new_link</span><span class="p">(</span><span class="n">br_key</span><span class="p">,</span>
                        <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="n">new_F_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_br_key_with_new_link</span><span class="p">(</span><span class="n">br_key</span><span class="p">,</span>
                        <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="c1"># print(&#39;new keys=&#39;, new_F_key,&#39;,&#39;, new_T_key)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">new_T_key</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">old_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">new_F_key</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">old_st_vec_dict</span><span class="p">[</span><span class="n">br_key</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">new_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">new_T_key</span><span class="p">,</span> <span class="n">new_F_key</span><span class="p">]):</span>
                    <span class="c1"># set projection |b=0&gt;&lt;b=0| to zero for T key</span>
                    <span class="n">st_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span>
                    <span class="c1"># print(&quot;b, newkey=&quot; + str(b) + &quot;,&quot; + new_key)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">StateVec</span><span class="o">.</span><span class="n">is_zero</span><span class="p">(</span><span class="n">st_vec</span><span class="p">):</span>
                        <span class="n">slicex</span><span class="p">[</span><span class="n">tar_bit_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
                        <span class="n">st_vec</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slicex</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">tot_prob</span> <span class="o">=</span> <span class="n">st_vec</span><span class="o">.</span><span class="n">get_total_prob</span><span class="p">()</span>
                        <span class="c1"># print(&#39;tot_prob=&#39;, tot_prob)</span>
                        <span class="k">if</span> <span class="n">tot_prob</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">:</span>
                            <span class="c1"># this didn&#39;t work</span>
                            <span class="c1"># st_vec.arr = None</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">slicex</span><span class="p">[</span><span class="n">tar_bit_pos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                    <span class="c1"># print(st_vec)</span>

            <span class="c1"># print(self.cur_st_vec_dict)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;unsupported measurement kind&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_tf</span><span class="p">()</span></div>

<div class="viewcode-block" id="SEO_simulator.use_MP_Y"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_MP_Y">[docs]</a>    <span class="k">def</span> <span class="nf">use_MP_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">trols</span><span class="p">,</span> <span class="n">rad_angles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method should not be called. If called, it explains why it</span>
<span class="sd">        shouldn&#39;t be called.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        trols : Controls</span>
<span class="sd">        rad_angles : list[float]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> \
            <span class="s2">&quot;This class cannot simulate a circuit containing &quot;</span> \
            <span class="s2">&quot;raw multiplexors MP_Y. Work around: use first our&quot;</span> \
            <span class="s2">&quot;MultiplexorExpander class to expand &quot;</span> \
            <span class="s2">&quot;MP_Ys into simpler gates.&quot;</span></div>

<div class="viewcode-block" id="SEO_simulator.use_NOTA"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_NOTA">[docs]</a>    <span class="k">def</span> <span class="nf">use_NOTA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bla_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do nothing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bla_str : str</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="SEO_simulator.use_PHAS"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_PHAS">[docs]</a>    <span class="k">def</span> <span class="nf">use_PHAS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle_rads</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for PHAS.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle_rads : float</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">phase_fac</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">,</span> <span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_P_PH"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_P_PH">[docs]</a>    <span class="k">def</span> <span class="nf">use_P_PH</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projection_bit</span><span class="p">,</span>
                <span class="n">angle_rads</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for P_0 and P_1 phase factors.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        projection_bit : int</span>
<span class="sd">            0 (resp. 1) for P_0 (resp. P_1) projection</span>
<span class="sd">        angle_rads : float</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fun</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">P_0_phase_fac</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">:</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">P_1_phase_fac</span>
        <span class="p">}</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">fun</span><span class="p">[</span><span class="n">projection_bit</span><span class="p">](</span><span class="n">angle_rads</span><span class="p">,</span> <span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_PRINT"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_PRINT">[docs]</a>    <span class="k">def</span> <span class="nf">use_PRINT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">line_num</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints to screen a description of self.cur_st_vec_dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str</span>
<span class="sd">            style in which to print</span>
<span class="sd">        line_num : int</span>
<span class="sd">            line number in eng &amp; pic files in which PRINT command appears</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_numpy</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*************************beginning PRINT output&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PRINT line number=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">line_num</span><span class="p">))</span>
        <span class="n">st_vecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_st_vec_dict</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;V1&quot;</span><span class="p">:</span>
            <span class="n">StateVec</span><span class="o">.</span><span class="n">describe_st_vec_dict</span><span class="p">(</span><span class="n">st_vecs</span><span class="p">,</span>
                                        <span class="c1"># print_st_vec=True,</span>
                                        <span class="n">show_probs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;ALL&quot;</span><span class="p">:</span>
            <span class="n">StateVec</span><span class="o">.</span><span class="n">describe_st_vec_dict</span><span class="p">(</span><span class="n">st_vecs</span><span class="p">,</span>
                                        <span class="n">print_st_vec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">do_pp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">omit_zero_amps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">show_probs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># must store copy or it will change</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cached_sts</span><span class="p">[</span><span class="n">line_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">st_vecs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;unsupported PRINT style&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;****************************ending PRINT output&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_tensors_to_tf</span><span class="p">()</span></div>

<div class="viewcode-block" id="SEO_simulator.use_ROTA"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_ROTA">[docs]</a>    <span class="k">def</span> <span class="nf">use_ROTA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span>
                 <span class="n">angle_rads</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for rot along axes x, y, or z.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : int</span>
<span class="sd">            1, 2, 3 for x, y, z</span>
<span class="sd">        angle_rads : float</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># print(&#39;//////&#39;, angle_rads, axis)</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">rot_ax</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_ROTN"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_ROTN">[docs]</a>    <span class="k">def</span> <span class="nf">use_ROTN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle_x_rads</span><span class="p">,</span> <span class="n">angle_y_rads</span><span class="p">,</span> <span class="n">angle_z_rads</span><span class="p">,</span>
                <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for rot along arbitrary axis.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle_x_rads : float</span>
<span class="sd">        angle_y_rads : float</span>
<span class="sd">        angle_z_rads : float</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="n">angle_x_rads</span><span class="p">,</span> <span class="n">angle_y_rads</span><span class="p">,</span> <span class="n">angle_z_rads</span><span class="p">,</span>
                               <span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_SIG"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_SIG">[docs]</a>    <span class="k">def</span> <span class="nf">use_SIG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for sigx, sigy, sigz.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : int</span>
<span class="sd">            1, 2, 3 for x, y, z</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fun</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">1</span><span class="p">:</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">sigx</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">sigy</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">sigz</span>
        <span class="p">}</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">fun</span><span class="p">[</span><span class="n">axis</span><span class="p">](</span><span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_SWAP"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_SWAP">[docs]</a>    <span class="k">def</span> <span class="nf">use_SWAP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_bit_swap().</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bit1 : int</span>
<span class="sd">        bit2 : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_bit_swap</span><span class="p">(</span><span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">controls</span><span class="p">)</span></div>

<div class="viewcode-block" id="SEO_simulator.use_SWAY"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_SWAY">[docs]</a>    <span class="k">def</span> <span class="nf">use_SWAY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">rads_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() 3 times.</span>

<span class="sd">        This relies on the fact that</span>

<span class="sd">        SWAY(0, 1) = SWAY(1, 0) =</span>
<span class="sd">        X---@</span>
<span class="sd">        @---U2</span>
<span class="sd">        X---@</span>

<span class="sd">        U2 = exp(j*(rads0 + rads1*sig_x))</span>

<span class="sd">        rads_list = [rads0, rads1]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bit1 : int</span>
<span class="sd">        bit2 : int</span>
<span class="sd">        controls : Controls</span>
<span class="sd">        rads_list : list[float]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">controls1</span> <span class="o">=</span> <span class="n">Controls</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span>
        <span class="n">controls1</span><span class="o">.</span><span class="n">set_control</span><span class="p">(</span><span class="n">bit1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">do_refresh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># print(&#39;m,m,&#39;, bit1, bit2)</span>
        <span class="c1"># print(&quot;,m,m&quot;, controls1.bit_pos_to_kind)</span>

        <span class="n">controls2</span> <span class="o">=</span> <span class="n">Controls</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span>
        <span class="n">controls2</span><span class="o">.</span><span class="n">set_control</span><span class="p">(</span><span class="n">bit2</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">do_refresh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># print(&quot;,m,m&quot;, controls2.bit_pos_to_kind)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rads_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="n">rads0</span><span class="p">,</span> <span class="n">rads1</span> <span class="o">=</span> <span class="n">rads_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span>
            <span class="n">bit2</span><span class="p">,</span> <span class="n">controls1</span><span class="p">,</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">sigx</span><span class="p">(</span><span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span>
            <span class="n">bit1</span><span class="p">,</span> <span class="n">controls2</span><span class="p">,</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">u2</span><span class="p">(</span><span class="n">rads0</span><span class="p">,</span> <span class="n">rads1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                                            <span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span>
            <span class="n">bit2</span><span class="p">,</span> <span class="n">controls1</span><span class="p">,</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">sigx</span><span class="p">(</span><span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">))</span></div>

<div class="viewcode-block" id="SEO_simulator.use_U_2_"><a class="viewcode-back" href="../../qubiter.SEO_simulator.html#qubiter.SEO_simulator.SEO_simulator.use_U_2_">[docs]</a>    <span class="k">def</span> <span class="nf">use_U_2_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rads0</span><span class="p">,</span> <span class="n">rads1</span><span class="p">,</span> <span class="n">rads2</span><span class="p">,</span> <span class="n">rads3</span><span class="p">,</span>
                <span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides the parent class use_ function. Calls</span>
<span class="sd">        evolve_by_controlled_one_bit_gate() for arbitrary unitary 2-dim</span>
<span class="sd">        matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rads0 : float</span>
<span class="sd">        rads1 : float</span>
<span class="sd">        rads2 : float</span>
<span class="sd">        rads3 : float</span>
<span class="sd">        tar_bit_pos : int</span>
<span class="sd">        controls : Controls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gate</span> <span class="o">=</span> <span class="n">OneBitGates</span><span class="o">.</span><span class="n">u2</span><span class="p">(</span><span class="n">rads0</span><span class="p">,</span> <span class="n">rads1</span><span class="p">,</span> <span class="n">rads2</span><span class="p">,</span> <span class="n">rads3</span><span class="p">,</span> <span class="n">lib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolve_by_controlled_one_bit_gate</span><span class="p">(</span><span class="n">tar_bit_pos</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">gate</span><span class="p">)</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
        <span class="c1"># use test = 0 if want to run all tests at once.</span>
        <span class="n">test</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># test = 3</span>
        <span class="k">if</span> <span class="n">test</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="c1"># test on circuit for a quantum fourier transform</span>
            <span class="c1"># (no loops, no internal measurements)</span>
            <span class="n">sim</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="p">(</span><span class="s1">&#39;sim_test1&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">test</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="c1"># test embedded loops</span>
            <span class="n">sim</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="p">(</span><span class="s1">&#39;sim_test2&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">test</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="c1"># test MEAS branching. Each kind 2 measurement doubles number of</span>
            <span class="c1"># branches</span>
            <span class="n">sim</span> <span class="o">=</span> <span class="n">SEO_simulator</span><span class="p">(</span><span class="s1">&#39;sim_test3&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">main</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Robert R. Tucci &amp; Qubiter contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>